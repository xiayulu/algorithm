本节主要讲解计算机组成有关知识，学习本节有助于你理解和实现算法。

## 计算机系统组成

![计算机组成](https://sophia-1303119720.cos.ap-nanjing.myqcloud.com/course/936c97091ad530655eaf684bede406b2.png)

组成计算机的 5 个经典部件：输入、输出、存储器、数据通路（运算器）和控制器。数据通路和控制器合称为处理器。处理器从存储器获取指令和数据，输入不见将数据写入存储器，输出不见从存储器中读取数据。控制器向数据通路、存储器、输入和输出模块发出控制信号。

虽然实际的计算机系统会比这个简要的组成系统复杂几十甚至上百倍，但这个简单的模型已经足够帮助我们理解计算机系统了。

## 计算机指令

计算机的执行依赖于指令，一条指令可能包含如下信息：控制信息，数据，地址信息。每条指令都包含控制信息，例如读写使能信号，多选器的选择信号。从指令提取信息的过程称为指令译码。例如 MIPS 几种指令格式对应的信息如下图所示：

![MIPS指令格式](https://sophia-1303119720.cos.ap-nanjing.myqcloud.com/course/dffa9bb54e17ac8ba3d5a0591fd49bc2.png)

R 型指令执行过程，图片选自[计算机硬件系统设计_中国大学MOOC(慕课) ](https://www.icourse163.org/learn/HUST-1205809816?tid=1463030455#/learn/content?type=detail&id=1240161587&cid=1261491374)：

![指令执行示例](https://sophia-1303119720.cos.ap-nanjing.myqcloud.com/course/292b429b8ee0b2ab02fb9d765b9a6622.png)

例题：已知整数数组 A 的基地址存放在寄存器 `$t1` 中，h 的值存放在寄存器 `$s2` 中， 请把下列 C 语句翻译成 MIPS 汇编语言：

```c
A[300] = h + A[300];
```

【解】

```assembly
lw  $t0, 1200($t1)
add $t0, $s2, $t0
sw  $t0, 1200(t1)
```

## 存储器

存储器系统是一个具有不同容量、成本和访问时间的存储设备的层次结构。每一层于下一层相比都拥有较高的速度和较低延迟性，以及较小的容量。

存储器层次结构，对应用程序的性能有着巨大的影响。理解系统是如何将数据在存储器层次结构中上下移动，可写出更符合系统运行的应用程序，运行更快。

![存储器层次结构](https://sophia-1303119720.cos.ap-nanjing.myqcloud.com/course/430c2faef045e028ebf8f12bd07047bd.jpeg)

【局部性原理】
程序倾向于一次又一次地访问相同的数据集合，或倾向于访问邻近的数据集合。这种倾向性，我们称为**局部性原理**。局部性通常有以下两种形式：

**时间局部性**：被引用过一次的存储器位置的内容在不远的将来再被多次引用。
**空间局部性**：如果一个内存位置被引用了一次，那么程序很可能在不远的将来引用附近的一个内存位置。
一般而言，有良好局部性的程序比局部性差的程序运行得更快。现代计算机系统的各个层次，从硬件到操作系统、在到应用程序，它们的设计都利用了局部性。举例来说：

```c
int sum1(int array[N])
{
    int i, sum = 0;
    for(i = 0; i < N; i++)
        sum += array[i];
    return sum;
}
```

在这个程序中，变量 `sum, i `在每次循环迭代时被引用一次，因此对 `sum` 和 `i`来说，有较好的时间局部性。
对变量 `vec` 来说，它是一个 `int` 类型数组，循环时按顺序访问 `vec`，因为一个 C 数组在内存中是占用连续的内存空间，因而的较好的空间局部性。

再看一个例子：

```c
int sum2(int array[M][N])
{
    int i, j, sum = 0;
    for(i = 0; i < N; i++){
        for(j = 0; j < M; j++)
            sum += array[j][i];
    }
    return sum;
}
```

这是一个空间局部性很差的程序。假设这个数组是 `array[3][4]`,因为 C 数组在内存中是按行顺序来存放的。所以`sum2` 对每个数组元素的访问顺序成了这样：0， 4， 8， 1， 5， 9，……，7， 11，所以它的空间局部性很差，写成 `sum += array[i][j];` 就很好的利用了局部性原理。

## 参考文章

[什么是内存（一）：存储器层次结构 - eleven_yw - 博客园 (cnblogs.com)](https://www.cnblogs.com/yaoxiaowen/p/7805661.html)